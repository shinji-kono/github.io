<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>regex2</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-unsolved-metas</a> <a id="36" class="Symbol">#-}</a>

<a id="41" class="Keyword">open</a> <a id="46" class="Keyword">import</a> <a id="53" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="91" class="Keyword">hiding</a> <a id="98" class="Symbol">(</a> <a id="100" href="Relation.Binary.PropositionalEquality.html#2365" class="InductiveConstructor Operator">[_]</a> <a id="104" class="Symbol">)</a>
<a id="106" class="Keyword">open</a> <a id="111" class="Keyword">import</a> <a id="118" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="135" class="Keyword">using</a> <a id="141" class="Symbol">(</a><a id="142" href="Relation.Nullary.html#665" class="Function Operator">¬_</a><a id="144" class="Symbol">;</a> <a id="146" href="Relation.Nullary.html#1520" class="Record">Dec</a><a id="149" class="Symbol">;</a> <a id="151" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a><a id="154" class="Symbol">;</a> <a id="156" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a><a id="158" class="Symbol">)</a>
<a id="160" class="Keyword">open</a> <a id="165" class="Keyword">import</a> <a id="172" href="Data.List.html" class="Module">Data.List</a> <a id="182" class="Keyword">hiding</a> <a id="189" class="Symbol">(</a> <a id="191" href="Data.List.Base.html#5034" class="Function Operator">[_]</a> <a id="195" class="Symbol">)</a>        
<a id="205" class="Keyword">open</a> <a id="210" class="Keyword">import</a> <a id="217" href="Data.Empty.html" class="Module">Data.Empty</a>                 
<a id="245" class="Keyword">open</a> <a id="250" class="Keyword">import</a> <a id="257" href="finiteSet.html" class="Module">finiteSet</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="finiteSetUtil.html" class="Module">finiteSetUtil</a>
<a id="293" class="Keyword">open</a> <a id="298" class="Keyword">import</a> <a id="305" href="fin.html" class="Module">fin</a>

<a id="310" class="Keyword">module</a> <a id="317" href="regex2.html" class="Module">regex2</a> <a id="324" class="Symbol">(</a> <a id="326" href="regex2.html#326" class="Bound">Σ</a> <a id="328" class="Symbol">:</a> <a id="330" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="333" class="Symbol">)</a> <a id="335" class="Symbol">(</a> <a id="337" href="regex2.html#337" class="Bound">fin</a> <a id="341" class="Symbol">:</a> <a id="343" href="finiteSet.html#516" class="Record">FiniteSet</a> <a id="353" href="regex2.html#326" class="Bound">Σ</a> <a id="355" class="Symbol">)</a> <a id="357" class="Symbol">(</a> <a id="359" href="regex2.html#359" class="Bound">eq?</a> <a id="363" class="Symbol">:</a> <a id="365" class="Symbol">(</a><a id="366" href="regex2.html#366" class="Bound">x</a> <a id="368" href="regex2.html#368" class="Bound">y</a> <a id="370" class="Symbol">:</a> <a id="372" href="regex2.html#326" class="Bound">Σ</a><a id="373" class="Symbol">)</a> <a id="375" class="Symbol">→</a> <a id="377" href="Relation.Nullary.html#1520" class="Record">Dec</a> <a id="381" class="Symbol">(</a><a id="382" href="regex2.html#366" class="Bound">x</a> <a id="384" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="386" href="regex2.html#368" class="Bound">y</a><a id="387" class="Symbol">))</a> <a id="390" class="Keyword">where</a>

<a id="397" class="Keyword">open</a> <a id="402" class="Keyword">import</a> <a id="409" href="Level.html" class="Module">Level</a> <a id="415" class="Keyword">renaming</a> <a id="424" class="Symbol">(</a> <a id="426" href="Agda.Primitive.html#774" class="Primitive">suc</a> <a id="430" class="Symbol">to</a> <a id="433" class="Primitive">succ</a> <a id="438" class="Symbol">;</a> <a id="440" href="Agda.Primitive.html#758" class="Primitive">zero</a> <a id="445" class="Symbol">to</a> <a id="448" class="Primitive">Zero</a> <a id="453" class="Symbol">)</a>
<a id="455" class="Keyword">open</a> <a id="460" class="Keyword">import</a> <a id="467" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="476" class="Keyword">hiding</a> <a id="483" class="Symbol">(</a> <a id="485" href="Data.Fin.Base.html#5950" class="Function">pred</a> <a id="490" class="Symbol">)</a>
<a id="492" class="Keyword">open</a> <a id="497" class="Keyword">import</a> <a id="504" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="513" class="Keyword">hiding</a> <a id="520" class="Symbol">(</a> <a id="522" href="Data.Nat.Properties.html#2538" class="Function Operator">_≟_</a> <a id="526" class="Symbol">)</a>
<a id="528" class="Keyword">open</a> <a id="533" class="Keyword">import</a> <a id="540" href="Data.List.html" class="Module">Data.List</a> <a id="550" class="Keyword">hiding</a> <a id="557" class="Symbol">(</a> <a id="559" href="Data.List.Base.html#4686" class="Function">any</a> <a id="563" class="Symbol">;</a>  <a id="566" href="Data.List.Base.html#5034" class="Function Operator">[_]</a> <a id="570" class="Symbol">)</a>
<a id="572" class="Comment">-- import Data.Bool using ( Bool ; true ; false ; _∧_ )</a>
<a id="628" class="Comment">-- open import Data.Bool using ( Bool ; true ; false ; _∧_ ; _∨_ )</a>
<a id="695" class="Keyword">open</a> <a id="700" class="Keyword">import</a>  <a id="708" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="746" class="Symbol">as</a> <a id="749" class="Module">RBF</a> <a id="753" class="Keyword">hiding</a> <a id="760" class="Symbol">(</a> <a id="762" href="Relation.Binary.PropositionalEquality.html#2365" class="InductiveConstructor Operator">[_]</a> <a id="766" class="Symbol">)</a> 
<a id="769" class="Keyword">open</a> <a id="774" class="Keyword">import</a> <a id="781" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="798" class="Keyword">using</a> <a id="804" class="Symbol">(</a><a id="805" href="Relation.Nullary.html#665" class="Function Operator">¬_</a><a id="807" class="Symbol">;</a> <a id="809" href="Relation.Nullary.html#1520" class="Record">Dec</a><a id="812" class="Symbol">;</a> <a id="814" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a><a id="817" class="Symbol">;</a> <a id="819" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a><a id="821" class="Symbol">)</a>
<a id="823" class="Keyword">open</a> <a id="828" class="Keyword">import</a> <a id="835" href="regex.html" class="Module">regex</a>
<a id="841" class="Keyword">open</a> <a id="846" class="Keyword">import</a> <a id="853" href="regular-language.html" class="Module">regular-language</a>
<a id="870" class="Keyword">open</a> <a id="875" class="Keyword">import</a> <a id="882" href="automaton.html" class="Module">automaton</a>
<a id="892" class="Keyword">open</a> <a id="897" class="Keyword">import</a> <a id="904" href="logic.html" class="Module">logic</a>

<a id="911" class="Keyword">open</a> <a id="916" class="Keyword">import</a> <a id="923" href="regular-star.html" class="Module">regular-star</a> 
<a id="937" class="Keyword">open</a> <a id="942" class="Keyword">import</a> <a id="949" href="regular-concat.html" class="Module">regular-concat</a> 

<a id="966" class="Keyword">open</a> <a id="971" href="automaton.html#159" class="Module">Automaton</a>
<a id="981" class="Keyword">open</a> <a id="986" href="finiteSet.html#516" class="Module">FiniteSet</a>

<a id="997" class="Keyword">open</a> <a id="1002" href="regular-language.html#2025" class="Module">RegularLanguage</a>

<a id="regex→RegularLanguage"></a><a id="1019" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="1041" class="Symbol">:</a> <a id="1043" href="regex.html#539" class="Datatype">Regex</a> <a id="1049" href="regex2.html#326" class="Bound">Σ</a> <a id="1051" class="Symbol">→</a> <a id="1053" href="regular-language.html#2025" class="Record">RegularLanguage</a> <a id="1069" href="regex2.html#326" class="Bound">Σ</a>
<a id="1071" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="1093" href="regex.html#571" class="InductiveConstructor">ε</a> <a id="1095" class="Symbol">=</a> <a id="1097" class="Keyword">record</a> <a id="1104" class="Symbol">{</a> <a id="1106" href="regular-language.html#2091" class="Field">states</a> <a id="1113" class="Symbol">=</a> <a id="1115" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="1119" href="logic.html#380" class="Datatype Operator">∨</a> <a id="1121" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="1125" class="Symbol">;</a> <a id="1127" href="regular-language.html#2110" class="Field">astart</a> <a id="1134" class="Symbol">=</a> <a id="1136" href="logic.html#449" class="InductiveConstructor">case1</a> <a id="1142" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a> <a id="1146" class="Symbol">;</a> <a id="1148" href="regular-language.html#2132" class="Field">afin</a> <a id="1153" class="Symbol">=</a> <a id="1155" href="finiteSetUtil.html#6868" class="Function">fin-∨1</a> <a id="1162" href="finiteSetUtil.html#6677" class="Function">finOne</a>
    <a id="1173" class="Symbol">;</a> <a id="1175" href="regular-language.html#2162" class="Field">automaton</a> <a id="1185" class="Symbol">=</a> <a id="1187" class="Keyword">record</a> <a id="1194" class="Symbol">{</a> <a id="1196" href="automaton.html#232" class="Field">δ</a> <a id="1198" class="Symbol">=</a> <a id="1200" class="Symbol">λ</a> <a id="1202" href="regex2.html#1202" class="Bound">_</a> <a id="1204" href="regex2.html#1204" class="Bound">_</a> <a id="1206" class="Symbol">→</a> <a id="1208" href="logic.html#470" class="InductiveConstructor">case2</a> <a id="1214" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a> <a id="1218" class="Symbol">;</a> <a id="1220" href="automaton.html#254" class="Field">aend</a> <a id="1225" class="Symbol">=</a> <a id="1227" href="regex2.html#1248" class="Function">rg00</a> <a id="1232" class="Symbol">}</a> <a id="1234" class="Symbol">}</a> <a id="1236" class="Keyword">where</a>
      <a id="1248" href="regex2.html#1248" class="Function">rg00</a> <a id="1253" class="Symbol">:</a> <a id="1255" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="1259" href="logic.html#380" class="Datatype Operator">∨</a> <a id="1261" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="1265" class="Symbol">→</a> <a id="1267" href="logic.html#140" class="Datatype">Bool</a>
      <a id="1278" href="regex2.html#1248" class="Function">rg00</a> <a id="1283" class="Symbol">(</a><a id="1284" href="logic.html#449" class="InductiveConstructor">case1</a> <a id="1290" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a><a id="1293" class="Symbol">)</a> <a id="1295" class="Symbol">=</a> <a id="1297" href="logic.html#161" class="InductiveConstructor">true</a>
      <a id="1308" href="regex2.html#1248" class="Function">rg00</a> <a id="1313" class="Symbol">(</a><a id="1314" href="logic.html#470" class="InductiveConstructor">case2</a> <a id="1320" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a><a id="1323" class="Symbol">)</a> <a id="1325" class="Symbol">=</a> <a id="1327" href="logic.html#177" class="InductiveConstructor">false</a>
<a id="1333" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="1355" href="regex.html#613" class="InductiveConstructor">φ</a> <a id="1357" class="Symbol">=</a> <a id="1359" class="Keyword">record</a> <a id="1366" class="Symbol">{</a> <a id="1368" href="regular-language.html#2091" class="Field">states</a> <a id="1375" class="Symbol">=</a> <a id="1377" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="1381" class="Symbol">;</a> <a id="1383" href="regular-language.html#2110" class="Field">astart</a> <a id="1390" class="Symbol">=</a> <a id="1392" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a> <a id="1396" class="Symbol">;</a> <a id="1398" href="regular-language.html#2132" class="Field">afin</a> <a id="1403" class="Symbol">=</a> <a id="1405" href="finiteSetUtil.html#6677" class="Function">finOne</a> <a id="1412" class="Symbol">;</a> <a id="1414" href="regular-language.html#2162" class="Field">automaton</a> <a id="1424" class="Symbol">=</a> <a id="1426" class="Keyword">record</a> <a id="1433" class="Symbol">{</a> <a id="1435" href="automaton.html#232" class="Field">δ</a> <a id="1437" class="Symbol">=</a> <a id="1439" class="Symbol">λ</a> <a id="1441" href="regex2.html#1441" class="Bound">_</a> <a id="1443" href="regex2.html#1443" class="Bound">_</a> <a id="1445" class="Symbol">→</a> <a id="1447" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a> <a id="1451" class="Symbol">;</a> <a id="1453" href="automaton.html#254" class="Field">aend</a> <a id="1458" class="Symbol">=</a> <a id="1460" class="Symbol">λ</a> <a id="1462" href="regex2.html#1462" class="Bound">_</a> <a id="1464" class="Symbol">→</a> <a id="1466" href="logic.html#177" class="InductiveConstructor">false</a> <a id="1472" class="Symbol">}</a> <a id="1474" class="Symbol">}</a>
<a id="1476" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="1498" class="Symbol">(</a><a id="1499" href="regex2.html#1499" class="Bound">r</a> <a id="1501" href="regex.html#654" class="InductiveConstructor Operator">*</a><a id="1502" class="Symbol">)</a> <a id="1504" class="Symbol">=</a> <a id="1506" href="regular-star.html#1507" class="Function">M-Star</a> <a id="1513" class="Symbol">(</a> <a id="1515" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="1537" href="regex2.html#1499" class="Bound">r</a> <a id="1539" class="Symbol">)</a>
<a id="1541" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="1563" class="Symbol">(</a><a id="1564" href="regex2.html#1564" class="Bound">r</a> <a id="1566" href="regex.html#686" class="InductiveConstructor Operator">&amp;</a> <a id="1568" href="regex2.html#1568" class="Bound">r₁</a><a id="1570" class="Symbol">)</a> <a id="1572" class="Symbol">=</a> <a id="1574" href="regular-concat.html#1653" class="Function">M-Concat</a> <a id="1583" class="Symbol">(</a> <a id="1585" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="1607" href="regex2.html#1564" class="Bound">r</a> <a id="1609" class="Symbol">)</a> <a id="1611" class="Symbol">(</a><a id="1612" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="1634" href="regex2.html#1568" class="Bound">r₁</a> <a id="1637" class="Symbol">)</a>
<a id="1639" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="1661" class="Symbol">(</a><a id="1662" href="regex2.html#1662" class="Bound">r</a> <a id="1664" href="regex.html#727" class="InductiveConstructor Operator">||</a> <a id="1667" href="regex2.html#1667" class="Bound">r₁</a><a id="1669" class="Symbol">)</a> <a id="1671" class="Symbol">=</a> <a id="1673" href="regular-language.html#2908" class="Function">M-Union</a> <a id="1681" class="Symbol">(</a> <a id="1683" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="1705" href="regex2.html#1662" class="Bound">r</a> <a id="1707" class="Symbol">)</a> <a id="1709" class="Symbol">(</a><a id="1710" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="1732" href="regex2.html#1667" class="Bound">r₁</a> <a id="1735" class="Symbol">)</a>
<a id="1737" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="1759" href="regex.html#768" class="InductiveConstructor Operator">&lt;</a> <a id="1761" href="regex2.html#1761" class="Bound">x</a> <a id="1763" href="regex.html#768" class="InductiveConstructor Operator">&gt;</a> <a id="1765" class="Symbol">=</a> <a id="1767" class="Keyword">record</a> <a id="1774" class="Symbol">{</a> <a id="1776" href="regular-language.html#2091" class="Field">states</a> <a id="1783" class="Symbol">=</a> <a id="1785" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="1789" href="logic.html#380" class="Datatype Operator">∨</a> <a id="1791" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="1795" href="logic.html#380" class="Datatype Operator">∨</a> <a id="1797" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="1801" class="Symbol">;</a> <a id="1803" href="regular-language.html#2110" class="Field">astart</a> <a id="1810" class="Symbol">=</a> <a id="1812" href="logic.html#449" class="InductiveConstructor">case1</a> <a id="1818" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a> <a id="1822" class="Symbol">;</a> <a id="1824" href="regular-language.html#2132" class="Field">afin</a> <a id="1829" class="Symbol">=</a> <a id="1831" href="finiteSetUtil.html#6868" class="Function">fin-∨1</a> <a id="1838" class="Symbol">(</a><a id="1839" href="finiteSetUtil.html#6868" class="Function">fin-∨1</a> <a id="1846" href="finiteSetUtil.html#6677" class="Function">finOne</a><a id="1852" class="Symbol">)</a>
     <a id="1859" class="Symbol">;</a> <a id="1861" href="regular-language.html#2162" class="Field">automaton</a> <a id="1871" class="Symbol">=</a> <a id="1873" class="Keyword">record</a> <a id="1880" class="Symbol">{</a> <a id="1882" href="automaton.html#232" class="Field">δ</a> <a id="1884" class="Symbol">=</a> <a id="1886" href="regex2.html#2160" class="Function">rg01</a> <a id="1891" class="Symbol">;</a> <a id="1893" href="automaton.html#254" class="Field">aend</a> <a id="1898" class="Symbol">=</a> <a id="1900" href="regex2.html#1921" class="Function">rg00</a> <a id="1905" class="Symbol">}</a> <a id="1907" class="Symbol">}</a> <a id="1909" class="Keyword">where</a>
      <a id="1921" href="regex2.html#1921" class="Function">rg00</a> <a id="1926" class="Symbol">:</a> <a id="1928" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="1932" href="logic.html#380" class="Datatype Operator">∨</a> <a id="1934" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="1938" href="logic.html#380" class="Datatype Operator">∨</a> <a id="1940" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="1944" class="Symbol">→</a> <a id="1946" href="logic.html#140" class="Datatype">Bool</a>
      <a id="1957" href="regex2.html#1921" class="Function">rg00</a> <a id="1962" class="Symbol">(</a><a id="1963" href="logic.html#449" class="InductiveConstructor">case1</a> <a id="1969" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a><a id="1972" class="Symbol">)</a> <a id="1974" class="Symbol">=</a> <a id="1976" href="logic.html#177" class="InductiveConstructor">false</a>             <a id="1994" class="Comment">-- empty case failure</a>
      <a id="2022" href="regex2.html#1921" class="Function">rg00</a> <a id="2027" class="Symbol">(</a><a id="2028" href="logic.html#470" class="InductiveConstructor">case2</a> <a id="2034" class="Symbol">(</a><a id="2035" href="logic.html#449" class="InductiveConstructor">case1</a> <a id="2041" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a><a id="2044" class="Symbol">))</a> <a id="2047" class="Symbol">=</a> <a id="2049" href="logic.html#161" class="InductiveConstructor">true</a>      <a id="2059" class="Comment">-- may true on this phase</a>
      <a id="2091" href="regex2.html#1921" class="Function">rg00</a> <a id="2096" class="Symbol">(</a><a id="2097" href="logic.html#470" class="InductiveConstructor">case2</a> <a id="2103" class="Symbol">(</a><a id="2104" href="logic.html#470" class="InductiveConstructor">case2</a> <a id="2110" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a><a id="2113" class="Symbol">))</a> <a id="2116" class="Symbol">=</a> <a id="2118" href="logic.html#177" class="InductiveConstructor">false</a>     <a id="2128" class="Comment">-- no success never after</a>
      <a id="2160" href="regex2.html#2160" class="Function">rg01</a> <a id="2165" class="Symbol">:</a> <a id="2167" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="2171" href="logic.html#380" class="Datatype Operator">∨</a> <a id="2173" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="2177" href="logic.html#380" class="Datatype Operator">∨</a> <a id="2179" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="2183" class="Symbol">→</a> <a id="2185" href="regex2.html#326" class="Bound">Σ</a> <a id="2187" class="Symbol">→</a> <a id="2189" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="2193" href="logic.html#380" class="Datatype Operator">∨</a> <a id="2195" href="finiteSetUtil.html#6647" class="Datatype">One</a> <a id="2199" href="logic.html#380" class="Datatype Operator">∨</a> <a id="2201" href="finiteSetUtil.html#6647" class="Datatype">One</a>
      <a id="2211" href="regex2.html#2160" class="Function">rg01</a> <a id="2216" class="Symbol">(</a><a id="2217" href="logic.html#449" class="InductiveConstructor">case1</a> <a id="2223" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a><a id="2226" class="Symbol">)</a> <a id="2228" href="regex2.html#2228" class="Bound">s</a> <a id="2230" class="Keyword">with</a> <a id="2235" href="regex2.html#359" class="Bound">eq?</a> <a id="2239" href="regex2.html#2228" class="Bound">s</a> <a id="2241" href="regex2.html#1761" class="Bound">x</a>
      <a id="2249" class="Symbol">...</a> <a id="2253" class="Symbol">|</a> <a id="2255" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="2259" class="Symbol">_</a>  <a id="2262" class="Symbol">=</a> <a id="2264" href="logic.html#470" class="InductiveConstructor">case2</a> <a id="2270" class="Symbol">(</a><a id="2271" href="logic.html#449" class="InductiveConstructor">case1</a> <a id="2277" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a><a id="2280" class="Symbol">)</a>
      <a id="2288" class="Symbol">...</a> <a id="2292" class="Symbol">|</a> <a id="2294" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="2297" class="Symbol">_</a>   <a id="2301" class="Symbol">=</a> <a id="2303" href="logic.html#470" class="InductiveConstructor">case2</a> <a id="2309" class="Symbol">(</a><a id="2310" href="logic.html#470" class="InductiveConstructor">case2</a> <a id="2316" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a><a id="2319" class="Symbol">)</a>
      <a id="2327" href="regex2.html#2160" class="Function">rg01</a> <a id="2332" class="Symbol">(</a><a id="2333" href="logic.html#470" class="InductiveConstructor">case2</a> <a id="2339" class="Symbol">(</a><a id="2340" href="logic.html#449" class="InductiveConstructor">case1</a> <a id="2346" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a><a id="2349" class="Symbol">))</a> <a id="2352" href="regex2.html#2352" class="Bound">s</a> <a id="2354" class="Symbol">=</a> <a id="2356" href="logic.html#470" class="InductiveConstructor">case2</a> <a id="2362" class="Symbol">(</a><a id="2363" href="logic.html#470" class="InductiveConstructor">case2</a> <a id="2369" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a><a id="2372" class="Symbol">)</a>
      <a id="2380" href="regex2.html#2160" class="Function">rg01</a> <a id="2385" class="Symbol">(</a><a id="2386" href="logic.html#470" class="InductiveConstructor">case2</a> <a id="2392" class="Symbol">(</a><a id="2393" href="logic.html#470" class="InductiveConstructor">case2</a> <a id="2399" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a><a id="2402" class="Symbol">))</a> <a id="2405" href="regex2.html#2405" class="Bound">s</a> <a id="2407" class="Symbol">=</a> <a id="2409" href="logic.html#470" class="InductiveConstructor">case2</a> <a id="2415" class="Symbol">(</a><a id="2416" href="logic.html#470" class="InductiveConstructor">case2</a> <a id="2422" href="finiteSetUtil.html#6666" class="InductiveConstructor">one</a><a id="2425" class="Symbol">)</a>


<a id="2429" class="Keyword">open</a> <a id="2434" href="regular-concat.html#2611" class="Module">Split</a>

<a id="2441" class="Keyword">open</a> <a id="2446" href="logic.html#245" class="Module Operator">_∧_</a>

<a id="2451" class="Keyword">open</a> <a id="2456" class="Keyword">import</a> <a id="2463" href="Data.List.Properties.html" class="Module">Data.List.Properties</a>

<a id="regex-concat"></a><a id="2485" href="regex2.html#2485" class="Function">regex-concat</a> <a id="2498" class="Symbol">:</a> <a id="2500" class="Symbol">{</a><a id="2501" href="regex2.html#2501" class="Bound">a</a> <a id="2503" href="regex2.html#2503" class="Bound">b</a> <a id="2505" class="Symbol">:</a> <a id="2507" href="regex.html#539" class="Datatype">Regex</a> <a id="2513" href="regex2.html#326" class="Bound">Σ</a><a id="2514" class="Symbol">}</a> <a id="2516" class="Symbol">→</a> <a id="2518" class="Symbol">(</a><a id="2519" href="regex2.html#2519" class="Bound">x</a> <a id="2521" class="Symbol">:</a> <a id="2523" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2528" href="regex2.html#326" class="Bound">Σ</a><a id="2529" class="Symbol">)</a> <a id="2531" class="Symbol">→</a> <a id="2533" href="regex.html#844" class="Function">regex-language</a> <a id="2548" class="Symbol">(</a><a id="2549" href="regex2.html#2501" class="Bound">a</a> <a id="2551" href="regex.html#686" class="InductiveConstructor Operator">&amp;</a> <a id="2553" href="regex2.html#2503" class="Bound">b</a><a id="2554" class="Symbol">)</a> <a id="2556" href="regex2.html#359" class="Bound">eq?</a> <a id="2560" href="regex2.html#2519" class="Bound">x</a> <a id="2562" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2564" href="regular-language.html#827" class="Function">Concat</a> <a id="2571" class="Symbol">(</a><a id="2572" href="regex.html#844" class="Function">regex-language</a> <a id="2587" href="regex2.html#2501" class="Bound">a</a> <a id="2589" href="regex2.html#359" class="Bound">eq?</a><a id="2592" class="Symbol">)</a> <a id="2594" class="Symbol">(</a><a id="2595" href="regex.html#844" class="Function">regex-language</a> <a id="2610" href="regex2.html#2503" class="Bound">b</a> <a id="2612" href="regex2.html#359" class="Bound">eq?</a><a id="2615" class="Symbol">)</a> <a id="2617" href="regex2.html#2519" class="Bound">x</a>
<a id="2619" href="regex2.html#2485" class="Function">regex-concat</a>  <a id="2633" class="Symbol">{_}</a> <a id="2637" class="Symbol">{_}</a> <a id="2641" href="regex2.html#2641" class="Bound">x</a> <a id="2643" class="Symbol">=</a> <a id="2645" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="2651" class="Keyword">open</a> <a id="2656" class="Keyword">import</a> <a id="2663" href="sbconst2.html" class="Module">sbconst2</a>

<a id="regex-is-regular"></a><a id="2673" href="regex2.html#2673" class="Function">regex-is-regular</a> <a id="2690" class="Symbol">:</a>  <a id="2693" class="Symbol">(</a><a id="2694" href="regex2.html#2694" class="Bound">r</a> <a id="2696" class="Symbol">:</a> <a id="2698" href="regex.html#539" class="Datatype">Regex</a> <a id="2704" href="regex2.html#326" class="Bound">Σ</a> <a id="2706" class="Symbol">)</a> <a id="2708" class="Symbol">→</a> <a id="2710" class="Symbol">(</a> <a id="2712" href="regex2.html#2712" class="Bound">x</a> <a id="2714" class="Symbol">:</a> <a id="2716" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2721" href="regex2.html#326" class="Bound">Σ</a> <a id="2723" class="Symbol">)</a> <a id="2725" class="Symbol">→</a> <a id="2727" href="regular-language.html#2284" class="Function">isRegular</a> <a id="2737" class="Symbol">(</a><a id="2738" href="regex.html#844" class="Function">regex-language</a> <a id="2753" href="regex2.html#2694" class="Bound">r</a> <a id="2755" href="regex2.html#359" class="Bound">eq?</a><a id="2758" class="Symbol">)</a>  <a id="2761" href="regex2.html#2712" class="Bound">x</a> <a id="2763" class="Symbol">(</a> <a id="2765" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="2787" href="regex2.html#2694" class="Bound">r</a>  <a id="2790" class="Symbol">)</a>
<a id="2792" href="regex2.html#2673" class="Function">regex-is-regular</a> <a id="2809" href="regex2.html#2809" class="Bound">r</a> <a id="2811" href="regex2.html#2811" class="Bound">x</a> <a id="2813" class="Symbol">=</a> <a id="2815" href="regex2.html#2836" class="Function">rg00</a> <a id="2820" href="regex2.html#2809" class="Bound">r</a> <a id="2822" href="regex2.html#2811" class="Bound">x</a> <a id="2824" class="Keyword">where</a>
      <a id="2836" href="regex2.html#2836" class="Function">rg00</a> <a id="2841" class="Symbol">:</a> <a id="2843" class="Symbol">(</a><a id="2844" href="regex2.html#2844" class="Bound">r</a> <a id="2846" class="Symbol">:</a> <a id="2848" href="regex.html#539" class="Datatype">Regex</a> <a id="2854" href="regex2.html#326" class="Bound">Σ</a><a id="2855" class="Symbol">)</a> <a id="2857" class="Symbol">→</a> <a id="2859" class="Symbol">(</a><a id="2860" href="regex2.html#2860" class="Bound">x</a> <a id="2862" class="Symbol">:</a> <a id="2864" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2869" href="regex2.html#326" class="Bound">Σ</a><a id="2870" class="Symbol">)</a> <a id="2872" class="Symbol">→</a>   <a id="2876" href="regex.html#844" class="Function">regex-language</a> <a id="2891" href="regex2.html#2844" class="Bound">r</a> <a id="2893" href="regex2.html#359" class="Bound">eq?</a> <a id="2897" href="regex2.html#2860" class="Bound">x</a> <a id="2899" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2901" href="automaton.html#287" class="Function">accept</a> <a id="2908" class="Symbol">(</a><a id="2909" href="regular-language.html#2162" class="Field">automaton</a> <a id="2919" class="Symbol">(</a><a id="2920" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="2942" href="regex2.html#2844" class="Bound">r</a><a id="2943" class="Symbol">))</a> <a id="2946" class="Symbol">(</a><a id="2947" href="regular-language.html#2110" class="Field">astart</a> <a id="2954" class="Symbol">(</a><a id="2955" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="2977" href="regex2.html#2844" class="Bound">r</a><a id="2978" class="Symbol">))</a> <a id="2981" href="regex2.html#2860" class="Bound">x</a> 
      <a id="2990" href="regex2.html#2836" class="Function">rg00</a> <a id="2995" href="regex.html#571" class="InductiveConstructor">ε</a> <a id="2997" href="regex2.html#2997" class="Bound">x</a> <a id="2999" class="Symbol">=</a> <a id="3001" class="Hole">?</a>
      <a id="3009" href="regex2.html#2836" class="Function">rg00</a> <a id="3014" href="regex.html#613" class="InductiveConstructor">φ</a> <a id="3016" href="regex2.html#3016" class="Bound">x</a> <a id="3018" class="Symbol">=</a> <a id="3020" class="Hole">?</a>
      <a id="3028" href="regex2.html#2836" class="Function">rg00</a> <a id="3033" class="Symbol">(</a><a id="3034" href="regex2.html#3034" class="Bound">r</a> <a id="3036" href="regex.html#654" class="InductiveConstructor Operator">*</a><a id="3037" class="Symbol">)</a> <a id="3039" href="regex2.html#3039" class="Bound">x</a> <a id="3041" class="Symbol">=</a> <a id="3043" class="Hole">?</a>
      <a id="3051" href="regex2.html#2836" class="Function">rg00</a> <a id="3056" class="Symbol">(</a><a id="3057" href="regex2.html#3057" class="Bound">r</a> <a id="3059" href="regex.html#686" class="InductiveConstructor Operator">&amp;</a> <a id="3061" href="regex2.html#3061" class="Bound">r₁</a><a id="3063" class="Symbol">)</a> <a id="3065" href="regex2.html#3065" class="Bound">x</a> <a id="3067" class="Symbol">=</a> <a id="3069" href="Relation.Binary.PropositionalEquality.Core.html#2815" class="Function Operator">begin</a>
              <a id="3089" href="regular-language.html#646" class="Function">split</a> <a id="3095" class="Symbol">(</a><a id="3096" href="regex.html#844" class="Function">regex-language</a> <a id="3111" href="regex2.html#3057" class="Bound">r</a> <a id="3113" href="regex2.html#359" class="Bound">eq?</a><a id="3116" class="Symbol">)</a> <a id="3118" class="Symbol">(</a><a id="3119" href="regex.html#844" class="Function">regex-language</a> <a id="3134" href="regex2.html#3061" class="Bound">r₁</a> <a id="3137" href="regex2.html#359" class="Bound">eq?</a><a id="3140" class="Symbol">)</a> <a id="3142" href="regex2.html#3065" class="Bound">x</a> <a id="3144" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="3147" href="Relation.Binary.PropositionalEquality.Core.html#1376" class="Function">cong₂</a> <a id="3153" class="Symbol">(λ</a> <a id="3156" href="regex2.html#3156" class="Bound">j</a> <a id="3158" href="regex2.html#3158" class="Bound">k</a> <a id="3160" class="Symbol">→</a> <a id="3162" href="regular-language.html#827" class="Function">Concat</a> <a id="3169" href="regex2.html#3156" class="Bound">j</a> <a id="3171" href="regex2.html#3158" class="Bound">k</a> <a id="3173" href="regex2.html#3065" class="Bound">x</a><a id="3174" class="Symbol">)</a> 
                   <a id="3196" class="Symbol">(</a><a id="3197" href="finiteSetUtil.html#884" class="Postulate">f-extensionality</a> <a id="3214" class="Symbol">(</a><a id="3215" href="regex2.html#2836" class="Function">rg00</a> <a id="3220" href="regex2.html#3057" class="Bound">r</a><a id="3221" class="Symbol">))</a> <a id="3224" class="Symbol">(</a><a id="3225" href="finiteSetUtil.html#884" class="Postulate">f-extensionality</a> <a id="3242" class="Symbol">(</a><a id="3243" href="regex2.html#2836" class="Function">rg00</a> <a id="3248" href="regex2.html#3061" class="Bound">r₁</a><a id="3250" class="Symbol">))</a>   <a id="3255" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
              <a id="3271" href="regular-language.html#827" class="Function">Concat</a> <a id="3278" class="Symbol">(</a><a id="3279" href="regular-language.html#2196" class="Function">contain</a> <a id="3287" class="Symbol">(</a><a id="3288" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="3310" href="regex2.html#3057" class="Bound">r</a><a id="3311" class="Symbol">))</a> <a id="3314" class="Symbol">(</a><a id="3315" href="regular-language.html#2196" class="Function">contain</a> <a id="3323" class="Symbol">(</a><a id="3324" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="3346" href="regex2.html#3061" class="Bound">r₁</a><a id="3348" class="Symbol">))</a> <a id="3351" href="regex2.html#3065" class="Bound">x</a> 
                  <a id="3372" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a>  <a id="3376" href="regular-concat.html#6104" class="Function">closed-in-concat</a> <a id="3393" class="Symbol">(</a><a id="3394" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="3416" href="regex2.html#3057" class="Bound">r</a><a id="3417" class="Symbol">)</a> <a id="3419" class="Symbol">(</a><a id="3420" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="3442" href="regex2.html#3061" class="Bound">r₁</a><a id="3444" class="Symbol">)</a> <a id="3446" href="regex2.html#3065" class="Bound">x</a> <a id="3448" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
              <a id="3464" href="regular-language.html#2196" class="Function">contain</a> <a id="3472" class="Symbol">(</a><a id="3473" href="regular-concat.html#1653" class="Function">M-Concat</a> <a id="3482" class="Symbol">(</a><a id="3483" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="3505" href="regex2.html#3057" class="Bound">r</a><a id="3506" class="Symbol">)</a> <a id="3508" class="Symbol">(</a><a id="3509" href="regex2.html#1019" class="Function">regex→RegularLanguage</a> <a id="3531" href="regex2.html#3061" class="Bound">r₁</a><a id="3533" class="Symbol">))</a> <a id="3536" href="regex2.html#3065" class="Bound">x</a>  <a id="3539" href="Relation.Binary.PropositionalEquality.Core.html#3114" class="Function Operator">∎</a>
                 <a id="3558" class="Keyword">where</a> <a id="3564" class="Keyword">open</a> <a id="3569" href="Relation.Binary.PropositionalEquality.Core.html#2717" class="Module">≡-Reasoning</a>
      <a id="3587" href="regex2.html#2836" class="Function">rg00</a> <a id="3592" class="Symbol">(</a><a id="3593" href="regex2.html#3593" class="Bound">r</a> <a id="3595" href="regex.html#727" class="InductiveConstructor Operator">||</a> <a id="3598" href="regex2.html#3598" class="Bound">r₁</a><a id="3600" class="Symbol">)</a> <a id="3602" href="regex2.html#3602" class="Bound">x</a> <a id="3604" class="Symbol">=</a> <a id="3606" class="Hole">?</a>
      <a id="3614" href="regex2.html#2836" class="Function">rg00</a> <a id="3619" href="regex.html#768" class="InductiveConstructor Operator">&lt;</a> <a id="3621" href="regex2.html#3621" class="Bound">s</a> <a id="3623" href="regex.html#768" class="InductiveConstructor Operator">&gt;</a> <a id="3625" href="regex2.html#3625" class="Bound">x</a> <a id="3627" class="Symbol">=</a> <a id="3629" class="Hole">?</a>

<a id="3632" class="Comment">-- end</a>
</pre></body></html>