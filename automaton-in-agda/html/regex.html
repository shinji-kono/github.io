<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>regex</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical-compatible</a> <a id="34" class="Pragma">--safe</a> <a id="41" class="Symbol">#-}</a>

<a id="46" class="Comment">-- {-# OPTIONS --allow-unsolved-metas #-}</a>
<a id="88" class="Keyword">module</a> <a id="95" href="regex.html" class="Module">regex</a> <a id="101" class="Keyword">where</a>

<a id="108" class="Keyword">open</a> <a id="113" class="Keyword">import</a> <a id="120" href="Level.html" class="Module">Level</a> <a id="126" class="Keyword">renaming</a> <a id="135" class="Symbol">(</a> <a id="137" href="Agda.Primitive.html#774" class="Primitive">suc</a> <a id="141" class="Symbol">to</a> <a id="144" class="Primitive">succ</a> <a id="149" class="Symbol">;</a> <a id="151" href="Agda.Primitive.html#758" class="Primitive">zero</a> <a id="156" class="Symbol">to</a> <a id="159" class="Primitive">Zero</a> <a id="164" class="Symbol">)</a>
<a id="166" class="Keyword">open</a> <a id="171" class="Keyword">import</a> <a id="178" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="187" class="Keyword">hiding</a> <a id="194" class="Symbol">(</a> <a id="196" href="Data.Fin.Base.html#6645" class="Function">pred</a> <a id="201" class="Symbol">)</a>
<a id="203" class="Keyword">open</a> <a id="208" class="Keyword">import</a> <a id="215" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="224" class="Keyword">hiding</a> <a id="231" class="Symbol">(</a> <a id="233" href="Data.Nat.Properties.html#3557" class="Function Operator">_≟_</a> <a id="237" class="Symbol">)</a>
<a id="239" class="Keyword">open</a> <a id="244" class="Keyword">import</a> <a id="251" href="Data.List.html" class="Module">Data.List</a> <a id="261" class="Keyword">hiding</a> <a id="268" class="Symbol">(</a> <a id="270" href="Data.List.Base.html#4892" class="Function">any</a> <a id="274" class="Symbol">;</a>  <a id="277" href="Data.List.Base.html#5240" class="Function Operator">[_]</a> <a id="281" class="Symbol">)</a>
<a id="283" class="Comment">-- import Data.Bool using ( Bool ; true ; false ; _∧_ )</a>
<a id="339" class="Comment">-- open import Data.Bool using ( Bool ; true ; false ; _∧_ ; _∨_ )</a>
<a id="406" class="Keyword">open</a> <a id="411" class="Keyword">import</a>  <a id="419" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="457" class="Symbol">as</a> <a id="460" class="Module">RBF</a> <a id="464" class="Keyword">hiding</a> <a id="471" class="Symbol">(</a> <a id="473" href="Relation.Binary.PropositionalEquality.html#4395" class="InductiveConstructor Operator">[_]</a> <a id="477" class="Symbol">)</a> 
<a id="480" class="Keyword">open</a> <a id="485" class="Keyword">import</a> <a id="492" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="509" class="Keyword">using</a> <a id="515" class="Symbol">(</a><a id="516" href="Relation.Nullary.Negation.Core.html#824" class="Function Operator">¬_</a><a id="518" class="Symbol">;</a> <a id="520" href="Relation.Nullary.Decidable.Core.html#1490" class="Record">Dec</a><a id="523" class="Symbol">;</a> <a id="525" href="Relation.Nullary.Decidable.Core.html#1627" class="InductiveConstructor">yes</a><a id="528" class="Symbol">;</a> <a id="530" href="Relation.Nullary.Decidable.Core.html#1664" class="InductiveConstructor">no</a><a id="532" class="Symbol">)</a>
<a id="534" class="Keyword">open</a> <a id="539" class="Keyword">import</a> <a id="546" href="logic.html" class="Module">logic</a>
<a id="552" class="Keyword">open</a> <a id="557" class="Keyword">import</a> <a id="564" href="regular-language.html" class="Module">regular-language</a>

<a id="582" class="Keyword">data</a> <a id="Regex"></a><a id="587" href="regex.html#587" class="Datatype">Regex</a> <a id="593" class="Symbol">(</a> <a id="595" href="regex.html#595" class="Bound">Σ</a> <a id="597" class="Symbol">:</a> <a id="599" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="602" class="Symbol">)</a> <a id="604" class="Symbol">:</a> <a id="606" href="Agda.Primitive.html#320" class="Primitive">Set</a>  <a id="611" class="Keyword">where</a>
  <a id="Regex.ε"></a><a id="619" href="regex.html#619" class="InductiveConstructor">ε</a>     <a id="625" class="Symbol">:</a> <a id="627" href="regex.html#587" class="Datatype">Regex</a> <a id="633" href="regex.html#595" class="Bound">Σ</a>                <a id="650" class="Comment">-- empty</a>
  <a id="Regex.φ"></a><a id="661" href="regex.html#661" class="InductiveConstructor">φ</a>     <a id="667" class="Symbol">:</a> <a id="669" href="regex.html#587" class="Datatype">Regex</a>  <a id="676" href="regex.html#595" class="Bound">Σ</a>               <a id="692" class="Comment">-- fail</a>
  <a id="Regex._*"></a><a id="702" href="regex.html#702" class="InductiveConstructor Operator">_*</a>    <a id="708" class="Symbol">:</a> <a id="710" href="regex.html#587" class="Datatype">Regex</a>  <a id="717" href="regex.html#595" class="Bound">Σ</a>  <a id="720" class="Symbol">→</a> <a id="722" href="regex.html#587" class="Datatype">Regex</a>  <a id="729" href="regex.html#595" class="Bound">Σ</a> 
  <a id="Regex._&amp;_"></a><a id="734" href="regex.html#734" class="InductiveConstructor Operator">_&amp;_</a>   <a id="740" class="Symbol">:</a> <a id="742" href="regex.html#587" class="Datatype">Regex</a>  <a id="749" href="regex.html#595" class="Bound">Σ</a>  <a id="752" class="Symbol">→</a> <a id="754" href="regex.html#587" class="Datatype">Regex</a>  <a id="761" href="regex.html#595" class="Bound">Σ</a> <a id="763" class="Symbol">→</a> <a id="765" href="regex.html#587" class="Datatype">Regex</a> <a id="771" href="regex.html#595" class="Bound">Σ</a>
  <a id="Regex._||_"></a><a id="775" href="regex.html#775" class="InductiveConstructor Operator">_||_</a>  <a id="781" class="Symbol">:</a> <a id="783" href="regex.html#587" class="Datatype">Regex</a>  <a id="790" href="regex.html#595" class="Bound">Σ</a>  <a id="793" class="Symbol">→</a> <a id="795" href="regex.html#587" class="Datatype">Regex</a>  <a id="802" href="regex.html#595" class="Bound">Σ</a> <a id="804" class="Symbol">→</a> <a id="806" href="regex.html#587" class="Datatype">Regex</a> <a id="812" href="regex.html#595" class="Bound">Σ</a>
  <a id="Regex.&lt;_&gt;"></a><a id="816" href="regex.html#816" class="InductiveConstructor Operator">&lt;_&gt;</a>   <a id="822" class="Symbol">:</a> <a id="824" href="regex.html#595" class="Bound">Σ</a> <a id="826" class="Symbol">→</a> <a id="828" href="regex.html#587" class="Datatype">Regex</a>  <a id="835" href="regex.html#595" class="Bound">Σ</a>

<a id="838" class="Keyword">infixr</a> <a id="845" class="Number">40</a> <a id="848" href="regex.html#734" class="InductiveConstructor Operator">_&amp;_</a> <a id="852" href="regex.html#775" class="InductiveConstructor Operator">_||_</a>

<a id="858" class="Comment">-- Meaning of regular expression</a>

<a id="regex-language"></a><a id="892" href="regex.html#892" class="Function">regex-language</a> <a id="907" class="Symbol">:</a> <a id="909" class="Symbol">{</a><a id="910" href="regex.html#910" class="Bound">Σ</a> <a id="912" class="Symbol">:</a> <a id="914" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="917" class="Symbol">}</a> <a id="919" class="Symbol">→</a> <a id="921" href="regex.html#587" class="Datatype">Regex</a> <a id="927" href="regex.html#910" class="Bound">Σ</a> <a id="929" class="Symbol">→</a> <a id="931" class="Symbol">((</a><a id="933" href="regex.html#933" class="Bound">x</a> <a id="935" href="regex.html#935" class="Bound">y</a> <a id="937" class="Symbol">:</a> <a id="939" href="regex.html#910" class="Bound">Σ</a> <a id="941" class="Symbol">)</a> <a id="943" class="Symbol">→</a> <a id="945" href="Relation.Nullary.Decidable.Core.html#1490" class="Record">Dec</a> <a id="949" class="Symbol">(</a><a id="950" href="regex.html#933" class="Bound">x</a> <a id="952" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="954" href="regex.html#935" class="Bound">y</a><a id="955" class="Symbol">))</a>  <a id="959" class="Symbol">→</a>  <a id="962" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="967" href="regex.html#910" class="Bound">Σ</a> <a id="969" class="Symbol">→</a> <a id="971" href="logic.html#185" class="Datatype">Bool</a>
<a id="976" href="regex.html#892" class="Function">regex-language</a> <a id="991" href="regex.html#661" class="InductiveConstructor">φ</a> <a id="993" href="regex.html#993" class="Bound">cmp</a> <a id="997" class="Symbol">_</a> <a id="999" class="Symbol">=</a> <a id="1001" href="logic.html#222" class="InductiveConstructor">false</a>
<a id="1007" href="regex.html#892" class="Function">regex-language</a> <a id="1022" href="regex.html#619" class="InductiveConstructor">ε</a> <a id="1024" href="regex.html#1024" class="Bound">cmp</a> <a id="1028" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1031" class="Symbol">=</a> <a id="1033" href="logic.html#206" class="InductiveConstructor">true</a>
<a id="1038" href="regex.html#892" class="Function">regex-language</a> <a id="1053" href="regex.html#619" class="InductiveConstructor">ε</a> <a id="1055" href="regex.html#1055" class="Bound">cmp</a> <a id="1059" class="Symbol">(_</a> <a id="1062" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1064" class="Symbol">_)</a> <a id="1067" class="Symbol">=</a> <a id="1069" href="logic.html#222" class="InductiveConstructor">false</a>
<a id="1075" href="regex.html#892" class="Function">regex-language</a> <a id="1090" class="Symbol">(</a><a id="1091" href="regex.html#1091" class="Bound">x</a> <a id="1093" href="regex.html#702" class="InductiveConstructor Operator">*</a><a id="1094" class="Symbol">)</a> <a id="1096" href="regex.html#1096" class="Bound">cmp</a> <a id="1100" class="Symbol">=</a> <a id="1102" href="regular-language.html#1159" class="Function">repeat</a> <a id="1109" class="Symbol">(</a> <a id="1111" href="regex.html#892" class="Function">regex-language</a> <a id="1126" href="regex.html#1091" class="Bound">x</a> <a id="1128" href="regex.html#1096" class="Bound">cmp</a>  <a id="1133" class="Symbol">)</a>
<a id="1135" href="regex.html#892" class="Function">regex-language</a> <a id="1150" class="Symbol">(</a><a id="1151" href="regex.html#1151" class="Bound">x</a> <a id="1153" href="regex.html#734" class="InductiveConstructor Operator">&amp;</a> <a id="1155" href="regex.html#1155" class="Bound">y</a><a id="1156" class="Symbol">)</a> <a id="1158" href="regex.html#1158" class="Bound">cmp</a>  <a id="1163" class="Symbol">=</a> <a id="1165" href="regular-language.html#691" class="Function">split</a> <a id="1171" class="Symbol">(</a> <a id="1173" class="Symbol">λ</a> <a id="1175" href="regex.html#1175" class="Bound">z</a> <a id="1177" class="Symbol">→</a> <a id="1179" href="regex.html#892" class="Function">regex-language</a> <a id="1194" href="regex.html#1151" class="Bound">x</a>  <a id="1197" href="regex.html#1158" class="Bound">cmp</a> <a id="1201" href="regex.html#1175" class="Bound">z</a> <a id="1203" class="Symbol">)</a> <a id="1205" class="Symbol">(λ</a> <a id="1208" href="regex.html#1208" class="Bound">z</a> <a id="1210" class="Symbol">→</a>  <a id="1213" href="regex.html#892" class="Function">regex-language</a> <a id="1228" href="regex.html#1155" class="Bound">y</a>  <a id="1231" href="regex.html#1158" class="Bound">cmp</a> <a id="1235" href="regex.html#1208" class="Bound">z</a> <a id="1237" class="Symbol">)</a>
<a id="1239" href="regex.html#892" class="Function">regex-language</a> <a id="1254" class="Symbol">(</a><a id="1255" href="regex.html#1255" class="Bound">x</a> <a id="1257" href="regex.html#775" class="InductiveConstructor Operator">||</a> <a id="1260" href="regex.html#1260" class="Bound">y</a><a id="1261" class="Symbol">)</a> <a id="1263" href="regex.html#1263" class="Bound">cmp</a>  <a id="1268" class="Symbol">=</a> <a id="1270" class="Symbol">λ</a> <a id="1272" href="regex.html#1272" class="Bound">s</a> <a id="1274" class="Symbol">→</a> <a id="1276" class="Symbol">(</a> <a id="1278" href="regex.html#892" class="Function">regex-language</a> <a id="1293" href="regex.html#1255" class="Bound">x</a>  <a id="1296" href="regex.html#1263" class="Bound">cmp</a> <a id="1300" href="regex.html#1272" class="Bound">s</a> <a id="1302" class="Symbol">)</a>  <a id="1305" href="logic.html#1540" class="Function Operator">\/</a>  <a id="1309" class="Symbol">(</a> <a id="1311" href="regex.html#892" class="Function">regex-language</a> <a id="1326" href="regex.html#1260" class="Bound">y</a>  <a id="1329" href="regex.html#1263" class="Bound">cmp</a> <a id="1333" href="regex.html#1272" class="Bound">s</a><a id="1334" class="Symbol">)</a>
<a id="1336" href="regex.html#892" class="Function">regex-language</a> <a id="1351" href="regex.html#816" class="InductiveConstructor Operator">&lt;</a> <a id="1353" href="regex.html#1353" class="Bound">h</a> <a id="1355" href="regex.html#816" class="InductiveConstructor Operator">&gt;</a> <a id="1357" href="regex.html#1357" class="Bound">cmp</a>  <a id="1362" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1365" class="Symbol">=</a> <a id="1367" href="logic.html#222" class="InductiveConstructor">false</a>
<a id="1373" href="regex.html#892" class="Function">regex-language</a> <a id="1388" href="regex.html#816" class="InductiveConstructor Operator">&lt;</a> <a id="1390" href="regex.html#1390" class="Bound">h</a> <a id="1392" href="regex.html#816" class="InductiveConstructor Operator">&gt;</a> <a id="1394" href="regex.html#1394" class="Bound">cmp</a>  <a id="1399" class="Symbol">(</a><a id="1400" href="regex.html#1400" class="Bound">h1</a>  <a id="1404" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1406" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1409" class="Symbol">)</a> <a id="1411" class="Keyword">with</a> <a id="1416" href="regex.html#1394" class="Bound">cmp</a> <a id="1420" href="regex.html#1390" class="Bound">h</a> <a id="1422" href="regex.html#1400" class="Bound">h1</a>
<a id="1425" class="Symbol">...</a> <a id="1429" class="Symbol">|</a> <a id="1431" href="Relation.Nullary.Decidable.Core.html#1627" class="InductiveConstructor">yes</a> <a id="1435" class="Symbol">_</a> <a id="1437" class="Symbol">=</a> <a id="1439" href="logic.html#206" class="InductiveConstructor">true</a>
<a id="1444" class="Symbol">...</a> <a id="1448" class="Symbol">|</a> <a id="1450" href="Relation.Nullary.Decidable.Core.html#1664" class="InductiveConstructor">no</a> <a id="1453" class="Symbol">_</a>  <a id="1456" class="Symbol">=</a> <a id="1458" href="logic.html#222" class="InductiveConstructor">false</a>
<a id="1464" href="regex.html#892" class="Function">regex-language</a> <a id="1479" href="regex.html#816" class="InductiveConstructor Operator">&lt;</a> <a id="1481" href="regex.html#1481" class="Bound">h</a> <a id="1483" href="regex.html#816" class="InductiveConstructor Operator">&gt;</a>  <a id="1486" class="Symbol">_</a> <a id="1488" class="Symbol">(_</a> <a id="1491" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1493" class="Symbol">_</a> <a id="1495" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1497" class="Symbol">_)</a>  <a id="1501" class="Symbol">=</a> <a id="1503" href="logic.html#222" class="InductiveConstructor">false</a>

</pre></body></html>